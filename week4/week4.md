<!-- footer: ソフトウェア工学　2018年度版　第4週-->
<!-- page_number: true -->

- 講義は 13:00 から始めます．
- Bb9 資料の Cloud9 を見て環境を整えておいてください．
- note_week4.docx または note_week4.md をグループで作成して，その PDF ファイル提出してもらうので，作成方法をグループで事前に打ち合わせをしておいてください．

---

# 第4週：ソフトウェア要求

## 要求分析
## ユースケース図
## ユースケース記述

---

# 課題

### note_week4.docx または note_week4.md をグループで分担して作成し，PDF化して Bb9 を通じて提出せよ．

---

# 第4週：ソフトウェア要求

## **要求分析**
## ユースケース図
## ユースケース記述

---

# 要求分析

### 典型的なソフトウェア開発工程

- **要求分析：ユーザの要求からシステムの仕様を決める**
- 設計：仕様を満足するような構造や実装方法を決める
- 構築：プログラムを作成する
- テスト：設計や仕様通りに動作するかを確認する
- 運用・保守：バグの修正や機能の追加する

<div class="box">
ソフトウェア開発において最も難しい工程
</div>

---

## 要求分析の必要性

### システム／ソフトウェア開発の目標

- ユーザの問題を解決すること
- **ステークホルダー**（stakeholder: 利害関係者）の要求を満足すること

### システム／ソフトウェア開発のリスク

- 要求分析段階におけるミスによる戻り作業は最も費用がかかる

<div class="box">
「要求」や「問題」の明確化が開発の成功の鍵
</div>

---

## 要求分析でやること

### ４つの基本プロセス
- 要求の抽出
- 要求の分析
- 要求の仕様化
- 要求の確認

---

## 要求の抽出

- ステークホルダー，文書，知識などから問題・要求を見つける．
- 典型的な手順
	- 目的の明確化：ユーザの目的や抱えている問題を抽出
	- 構造・業務・制約条件：対象領域（ドメイン）の分析
	- ステークホルダーの定義：対象ドメインのステークホルダーを抽出
	- 要求の抽出と明確化：ステークホルダーの要求・問題を網羅的に抽出
- 手法：資料収集，アンケート，インタビュー，観察，業務分析，ブレインストーミングなど
- 注意すること
	- ドメインの設定とステークホルダーの設定が重要！
	- 要求を網羅すること（隠れた要求：非機能要求）

---

## 要求の分析

- 抽出した要求を整理する
- 要求の**優先順位**を付ける
- 注意すること
	- 必要性：その要求が必要か？その度合いは？
	- 類似性：同じ要求を抽出しているか？まとめられるか？
	- 一貫性：矛盾した要求があるか？その矛盾を解決できるか？（優先順位）
	- 完全性（網羅性）：目的・目標にそった要求が全て抽出されているか？
	- 実現可能性：可能か？

---

## 要求の仕様化

- 要求分析結果をドキュメント化（仕様化）する
- 手法
	- ユースケース図などを利用
- 注意すること
	- 正確性：曖昧さがないか
	- 一貫性：業務制約などと矛盾がないか
	- 最小性：記述に重複がないか

---

## 要求の確認

- 仕様をもとにユーザ・ステークホルダーとの合意を行う
- 手法
	- レビュー，プロトタイピング，モデル化
- 注意すること
	- 要求内容がユーザやステークホルダーが考える内容とあっているか？
	- 要求の優先順位がユーザやステークホルダーが思っている優先順位とあっているか？
	- 要求の取捨選択：要求の範囲とコストの折り合い

---

## ビジネスモデル設計

- 最近ではユーザの要求**だけ**を満足するソフトウェアはごまんとある．
- ビジネス観点からの要求分析において重要な観点
	- アーリーアダプタ（Early adaptor）
		- 新たに登場した商品，サービス，ライフスタイルなどを比較的早期に受け入れる．
		- 口コミの世の中において重要なマーケティング要因
	- UVP (Unique Value Proprosition)：独自の価値提案
		- 競合他社・他製品との差別化

<div class="box">
リーンキャンバスなどの分析方法
</div>

---

*Exercise: mini_canvas.md の作成*

- ユーザ: 0min
- 課題（困っていること）: 5min
- 既存の代替サービス: 5min
- 独自の価値提案（UVP）: 5min
- ソリューション: 5min
- ステークホルダー: 0min
- 最終的なソリューション: 0min

---

# 第4週：ソフトウェア要求

## 要求分析
## **ユースケース図**
## ユースケース記述

---

# ユースケース図

- ユーザのシステム対する利用方法を視覚化
	- 一つのシステムに対して一つのユースケース図
- 構成要素（基本）
	- アクター（actor）
	- ユースケース（use case）
	- 関連（association）
	- システム領域（subject）

---

## ユースケース図：アクター（actor）

- システムとやりとりをする人やもの
	- システムのユースケースと関連付ける
	- システム外にいる人・組織，対外システムなど
- 記述
	- 人型の図形（最も標準的），コンピュータなどのアイコン

```uml
@startuml
skinparam shadowing false
scale 2

actor :ユーザ: as user
@enduml
```

---

## ユースケース図：ユースケース（use case）

- アクターから見たシステム利用
	- システムの機能
	- アクターにとって意味のある大きさとなるように粒度に気をつける
	- 「文字を打つ」は小さすぎる，「コミュニケーションをとる」は大きすぎる．「メールを送る」は適切
- 記述
	- 楕円に「ユースケース名」（能動態の動詞）を表記

```uml
@startuml
skinparam shadowing false
scale 2

usecase uc1 as "履修登録する"
usecase uc2 as "精算する\n--\n拡張点"

@enduml
```

---

## ユースケース図：関連（association）

- 関連のあるアクターとユースケースを示す
  - ユースケースを起動するアクター
  - ユースケースからの反応を得るアクター
  - アクター同士，ユースケース同士は関連付けない
- 記述

```uml
@startuml
skinparam shadowing false
scale 1.5
left to right direction

actor :学生: as s
actor :講義担当者: as o
actor :チューター: as t
usecase uc1 as "履修登録する"
usecase uc2 as "シラバスを登録する"
usecase uc3 as "成績を閲覧する"

s -- uc1
o -- uc2
s -- uc3
uc3 -- t

@enduml
```
---

## ユースケース図：システム領域（subject）

- システムを区切る枠
  - システム内部 vs. 外部
  - サブシステム vs. メインシステム
  - パッケージ（package）として表記することもある
- 記述：四角い枠

```uml
@startuml
skinparam shadowing false
scale 1.2
left to right direction

actor :学生: as s
actor :講義担当者: as o
actor :チューター: as t

rectangle "もみじ" {
usecase uc1 as "履修登録する"
usecase uc2 as "シラバスを登録する"
usecase uc3 as "成績を閲覧する"
}

s -- uc1
uc2 -- o
s -- uc3
uc3 -- t

@enduml
```

---

## ユースケース図の特徴

- 要求分析工程
  - システムの使い方をユーザに説明
  - 開発範囲を明確にする（境界線による範囲指定）
- 利点
  - システムの概略をとらえる
  - 視覚的にわかりやすい
- 欠点
  - ユースケース名の粒度や名前に気をつける
  - ユースケース名だけでは機能がわからない
  - ユーザの操作手順がわからない

---

## 構成要素（上級）

- 汎化
  - アクター：権限の継承（特別会員は一般会員にもなれる）
  - ユースケース：一部を書き換えたりサービスを付け加えたりして新しいユースケースを作成する
- 包含関係（include）
  - 点線の矢印とステレオタイプ`<<include>>`
  - あるユースケースを別のユースケースが含むことを表す
- 拡張関係（extend）
  - 点線の矢印とステレオタイプ`<<extend>>`
  - 別のユースケースがオプションとして選択可能（拡張）であることを表す

---

```uml
@startuml
skinparam shadowing false
scale 2
left to right direction

actor :一般会員: as s
actor :特別会員: as o

rectangle {
usecase uc1 as "ビデオを借りる\n--\n支払い方法"
usecase uc2 as "ビデオを宅配で借りる"
usecase uc3 as "会員かどうか確認する"
usecase uc4 as "カードで料金を支払う"
}

s <|-- o

s -- uc1
o -- uc2
uc1 <|-d- uc2
uc1 ..> uc3: <<include>>
uc1 <.. uc4: <<extend>>
@enduml
```
---

*Exercise: 共通例題（カロリー計算）のユースケース図を作成せよ*

- 10min

---

# 第4週：ソフトウェア要求

## 要求分析
## ユースケース図
## **ユースケース記述**

---

# ユースケース記述

## ユースケース記述とは？

- 詳細なフローを記述したドキュメント
- 一つのユースケースの詳細化

## なぜ？

- 図は直感的な理解には良いが「設計」なので詳細な記述が不可欠

## 基本構成要素（**ユースケース一つ毎**に以下を作成）

- ユースケース名
- 目的：ユースケース達成されるゴール
- 事前条件・事後条件（必要であれば）
- 基本フロー，例外フロー：「アクター」と「システム」のやりとり
- シナリオ：フローを具現化（複数個）

---

```uml
@startuml
skinparam shadowing false
scale 2
left to right direction

actor :貸出係: as act1
actor :登録係: as act2

rectangle {
usecase uc1 as "作品を会員に貸し出す"
usecase uc2 as "会員を新規登録する"
}

act1 -- uc1
act2 -- uc2
uc1 .d.> uc2: <<include>>
@enduml
```

---

## 目的

- 完成したときに実現される価値
- 簡潔に記述

```yaml
ユースケース名: 作品を会員に貸し出す
目的: 会員に作品を貸し出し，貸出料金の徴収と貸出記録の作成を行う
```

---

## 事前条件

- ユースケースを行う際に満たされているべき条件

## 事後条件

- ユースケースを行うことによって満たされる条件

```yaml
事前条件: |
  - システムが待機中であること
  - 貸出を希望する会員に会員が貸出を希望した作品が渡されていること
事後条件: |
  - システムに貸出記録が登録される
  - 作品の貸出期間に応じた貸出料金が徴収されている
```

---

## フロー

- アクターとシステムのやりとり（**システムの内部処理は書かない**）
- 主語や述語がアクター名や「システム」
- メインフロー：正常系のやりとり
- 代替フロー：正常系の別のやりとり
- 例外フロー：異常系のやりとり

---

```yaml
メインフロー: |
  1. 貸出係がシステムに作品の貸出を要求する
  2. システムは貸出係に会員情報の入力を求める
  3. 貸出係は貸出を希望する会員の会員情報を入力する（代替フロー1）
  4. システムは入力された会員情報が有効なものかを確認する（例外フロー1）
  5. システムは貸出係に貸出対象となる作品情報の入力を求める
  6. 貸出係はシステムに貸出対象となる作品情報を入力する
  7. システムは入力された作品情報が有効なものか確認する
  8. システムは貸出係に入力された作品情報を提示する
  9. 貸出係はすべての貸出対象となる作品情報を入力するまで6を繰り返す
  10. 貸出係は貸出対象となる作品情報をすべて入力し終わったことをシステムに通知する
  11. システムは貸出係に貸出期間の入力を求める
  12. 貸出係はシステムに貸出期間を入力する
  13. システムは料金の合計金額を計算し，貸出係に精算を求める
  14. 貸出係は会員からお金を受け取り，受け取った金額をシステム入力する
  15. システムは貸出記録を作成する
  16. システムは釣り銭を計算し，その金額を貸出係に提示する
  17. システムはレシートを印刷する
  18. 貸出係は会員に貸出対象作品とレシートをおつりを渡す
```

---

```yaml
代替フロー: |
  - 代替フロー1
    1. 貸出係は顧客が入会希望ならば，新規会員登録をシステムに要求する
    2. システムは「会員を新規登録する」を実行する
    3. メインフロー3に戻る
例外フロー: |
  - 例外フロー1
    1. システムは会員情報が無効な理由（有効期限切れ，店舗違い，会員情報の誤り）を貸出係に提示する
    2. システムはこのユースケースを中断する
    - 事後条件
      - システムは待機状態に戻る
      - 貸出係に会員情報が無効な理由が提示される
備考:
```

---

## シナリオ

- フローを具現化したもの
- 具体的な名前が入る

---

```yaml
シナリオ1: |
  - 作品を貸し出す（正常処理）
    - 事前条件: 貸出係（鈴木さん），会員（田中さん），貸出希望作品（作品Ａ，作品Ｂ），貸出期間（2泊3日），支払額５００円
    1. 鈴木さんがシステムに作品の貸出を要求する
    2. システムは貸出係に会員情報の入力を求める
    3. 鈴木さんは田中さんの会員情報を入力する
    4. システムは入力された会員情報が有効なものかを確認する
    5. システムは貸出係に貸出対象となる作品情報の入力を求める
    6. 鈴木さんはシステムに「作品Ａ」の情報を入力する
    7. システムは入力された「作品Ａ」の作品情報が有効なものか確認する
    8. システムは貸出係に「作品Ａ」の情報を提示する
    9. システムは貸出係に貸出対象となる作品情報の入力を求める
    10. 鈴木さんはシステムに「作品Ｂ」の情報を入力する
    11. システムは入力された「作品Ｂ」の作品情報が有効なものか確認する
    12. システムは貸出係に「作品Ｂ」の情報を提示する
    13. 鈴木さんは貸出対象となる作品情報をすべて入力し終わったことをシステムに通知する
    14. システムは貸出係に貸出期間の入力を求める
    15. 鈴木さんはシステムに２泊３日を入力する
    16. システムは貸出料金４００円の精算を貸出係に要求する
    17. 鈴木さんは田中さんから５００円受け取り，５００円とシステムに入力する
    18. システムは貸出記録を作成する
    19. システムは釣り銭を１００円であることを貸出係に提示する
    20. システムはレシートを印刷する
    21. 鈴木さんは田中さんに「作品Ａ」「作品Ｂ」とレシートとおつり１００円を渡す
```

---

## 他の設計図との整合性

### クラス図

- アクターはクラスとして書かない

### シーケンス図

- 一つのシナリオ毎に一つのシーケンス図を作成
- ユーザ（アクター）とシステムのメッセージのやりとりが「シナリオ」で記述したやりとりと合っていること

---

*Exercise: 共通例題（カロリー計算）のユースケース記述を作成せよ*

- 10min

---

# 課題

### note_week4.docx または note_week3.md をグループで分担して作成し，PDF化して Bb9 を通じて提出せよ．

---

# ふりかえり

- 今週のグループでの共同作業をふりかって，良かった点，悪かった点を議論する．
- 次回に向けて KPT を作っておく
	- K (Keep): 次回も続けること（良かったこと）
	- P (Problem): 今回問題となったこと（悪かったこと）
	- T (Try): 問題を解決するために次回自分たちがチャレンジすること
- Bb9 を通じて提出すること
